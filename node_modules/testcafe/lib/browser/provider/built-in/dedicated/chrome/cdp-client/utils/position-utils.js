"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getWindowPosition = exports.getElementFromPoint = exports.getIframePointRelativeToParentFrame = exports.getIframeClientCoordinates = exports.containsOffset = exports.getOffsetPosition = exports.getClientPosition = void 0;
const axis_values_1 = __importDefault(require("../../../../../../../shared/utils/values/axis-values"));
const boundary_values_1 = __importDefault(require("../../../../../../../shared/utils/values/boundary-values"));
const dom_utils_1 = require("./dom-utils");
const clientsManager = __importStar(require("../clients-manager"));
const style_utils_1 = require("./style-utils");
async function getClientPosition(node) {
    const boxModel = await style_utils_1.getBoxModel(node);
    return new axis_values_1.default(boxModel.border[0], boxModel.border[1]);
}
exports.getClientPosition = getClientPosition;
async function getOffsetPosition(node) {
    const dimensions = await style_utils_1.getClientDimensions(node);
    const { left, top } = await style_utils_1.getDocumentScroll(node);
    return { left: dimensions.left + left, top: dimensions.top + top };
}
exports.getOffsetPosition = getOffsetPosition;
async function containsOffset(node, offsetX, offsetY) {
    const dimensions = await style_utils_1.getClientDimensions(node);
    const properties = await style_utils_1.getProperties(node, 'scrollWidth', 'scrollHeight');
    const width = Math.max(Number(properties.scrollWidth), dimensions.width);
    const height = Math.max(Number(properties.scrollHeight), dimensions.height);
    const maxX = dimensions.scrollbar.right + dimensions.border.left + dimensions.border.right + width;
    const maxY = dimensions.scrollbar.bottom + dimensions.border.top + dimensions.border.bottom + height;
    return (typeof offsetX === 'undefined' || offsetX >= 0 && maxX >= offsetX) &&
        (typeof offsetY === 'undefined' || offsetY >= 0 && maxY >= offsetY);
}
exports.containsOffset = containsOffset;
async function getIframeClientCoordinates(node) {
    const dimensions = await style_utils_1.getClientDimensions(node);
    const [left, top, right, bottom] = [
        dimensions.left + dimensions.border.left + dimensions.paddings.left,
        dimensions.top + dimensions.border.top + dimensions.paddings.left,
        dimensions.right - dimensions.border.right - dimensions.paddings.right,
        dimensions.bottom - dimensions.border.bottom - dimensions.paddings.bottom,
    ];
    return new boundary_values_1.default(top, right, bottom, left);
}
exports.getIframeClientCoordinates = getIframeClientCoordinates;
async function getIframePointRelativeToParentFrame(iframePoint, context) {
    const iframe = await dom_utils_1.findIframeByWindow(context);
    if (!iframe)
        return null;
    const dimensions = await style_utils_1.getClientDimensions(iframe);
    const paddings = await style_utils_1.getElementPadding(iframe);
    const left = dimensions.left + dimensions.border.left + paddings.left + iframePoint.x;
    const top = dimensions.top + dimensions.border.top + paddings.top + iframePoint.y;
    return new axis_values_1.default(left, top);
}
exports.getIframePointRelativeToParentFrame = getIframePointRelativeToParentFrame;
async function getElementFromPoint(point) {
    const { DOM } = clientsManager.getClient();
    const { backendNodeId } = await DOM.getNodeForLocation({ x: point.x, y: point.y });
    return DOM.resolveNode({ backendNodeId });
}
exports.getElementFromPoint = getElementFromPoint;
async function getWindowPosition() {
    const { Runtime } = clientsManager.getClient();
    const args = {
        expression: `({
            x: window.screenLeft || window.screenX,
            y: window.screenTop || window.screenY
        })`,
        returnByValue: true,
    };
    const { result } = await Runtime.evaluate(args);
    return result.value;
}
exports.getWindowPosition = getWindowPosition;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9zaXRpb24tdXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvYnJvd3Nlci9wcm92aWRlci9idWlsdC1pbi9kZWRpY2F0ZWQvY2hyb21lL2NkcC1jbGllbnQvdXRpbHMvcG9zaXRpb24tdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLHVHQUFpSDtBQUNqSCwrR0FBOEc7QUFDOUcsMkNBQWlEO0FBQ2pELG1FQUFxRDtBQUdyRCwrQ0FNdUI7QUFFaEIsS0FBSyxVQUFVLGlCQUFpQixDQUFFLElBQWdCO0lBQ3JELE1BQU0sUUFBUSxHQUFHLE1BQU0seUJBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUV6QyxPQUFPLElBQUkscUJBQVUsQ0FBUyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMxRSxDQUFDO0FBSkQsOENBSUM7QUFFTSxLQUFLLFVBQVUsaUJBQWlCLENBQUUsSUFBZ0I7SUFDckQsTUFBTSxVQUFVLEdBQU0sTUFBTSxpQ0FBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN0RCxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxHQUFHLE1BQU0sK0JBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFcEQsT0FBTyxFQUFFLElBQUksRUFBRSxVQUFVLENBQUMsSUFBSSxHQUFHLElBQUksRUFBRSxHQUFHLEVBQUUsVUFBVSxDQUFDLEdBQUcsR0FBRyxHQUFHLEVBQUUsQ0FBQztBQUN2RSxDQUFDO0FBTEQsOENBS0M7QUFFTSxLQUFLLFVBQVUsY0FBYyxDQUFFLElBQWdCLEVBQUUsT0FBZSxFQUFFLE9BQWU7SUFDcEYsTUFBTSxVQUFVLEdBQUcsTUFBTSxpQ0FBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNuRCxNQUFNLFVBQVUs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QUVNLEtBQUssVUFBVSxtQkFBbUIsQ0FBRSxLQUE2QjtJQUNwRSxNQUFNLEVBQUUsR0FBRyxFQUFFLEdBQWEsY0FBYyxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ3JELE1BQU0sRUFBRSxhQUFhLEVBQUUsR0FBRyxNQUFNLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUVuRixPQUFPLEdBQUcsQ0FBQyxXQUFXLENBQUMsRUFBRSxhQUFhLEVBQUUsQ0FBQyxDQUFDO0FBQzlDLENBQUM7QUFMRCxrREFLQztBQUVNLEtBQUssVUFBVSxpQkFBaUI7SUFDbkMsTUFBTSxFQUFFLE9BQU8sRUFBRSxHQUFHLGNBQWMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUUvQyxNQUFNLElBQUksR0FBcUM7UUFDM0MsVUFBVSxFQUFFOzs7V0FHVDtRQUNILGFBQWEsRUFBRSxJQUFJO0tBQ3RCLENBQUM7SUFFRixNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsTUFBTSxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRWhELE9BQU8sTUFBTSxDQUFDLEtBQUssQ0FBQztBQUN4QixDQUFDO0FBZEQsOENBY0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUHJvdG9jb2wgZnJvbSAnZGV2dG9vbHMtcHJvdG9jb2wvdHlwZXMvcHJvdG9jb2wnO1xuaW1wb3J0IEV4ZWN1dGlvbkNvbnRleHQgZnJvbSAnLi4vZXhlY3V0aW9uLWNvbnRleHQnO1xuaW1wb3J0IEF4aXNWYWx1ZXMsIHsgQXhpc1ZhbHVlc0RhdGEsIExlZnRUb3BWYWx1ZXMgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi8uLi8uLi9zaGFyZWQvdXRpbHMvdmFsdWVzL2F4aXMtdmFsdWVzJztcbmltcG9ydCBCb3VuZGFyeVZhbHVlcywgeyBCb3VuZGFyeVZhbHVlc0RhdGEgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi8uLi8uLi9zaGFyZWQvdXRpbHMvdmFsdWVzL2JvdW5kYXJ5LXZhbHVlcyc7XG5pbXBvcnQgeyBmaW5kSWZyYW1lQnlXaW5kb3cgfSBmcm9tICcuL2RvbS11dGlscyc7XG5pbXBvcnQgKiBhcyBjbGllbnRzTWFuYWdlciBmcm9tICcuLi9jbGllbnRzLW1hbmFnZXInO1xuaW1wb3J0IHsgU2VydmVyTm9kZSB9IGZyb20gJy4uL3R5cGVzJztcblxuaW1wb3J0IHtcbiAgICBnZXRCb3hNb2RlbCxcbiAgICBnZXRDbGllbnREaW1lbnNpb25zLFxuICAgIGdldERvY3VtZW50U2Nyb2xsLFxuICAgIGdldEVsZW1lbnRQYWRkaW5nLFxuICAgIGdldFByb3BlcnRpZXMsXG59IGZyb20gJy4vc3R5bGUtdXRpbHMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2xpZW50UG9zaXRpb24gKG5vZGU6IFNlcnZlck5vZGUpOiBQcm9taXNlPEF4aXNWYWx1ZXM8bnVtYmVyPj4ge1xuICAgIGNvbnN0IGJveE1vZGVsID0gYXdhaXQgZ2V0Qm94TW9kZWwobm9kZSk7XG5cbiAgICByZXR1cm4gbmV3IEF4aXNWYWx1ZXM8bnVtYmVyPihib3hNb2RlbC5ib3JkZXJbMF0sIGJveE1vZGVsLmJvcmRlclsxXSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPZmZzZXRQb3NpdGlvbiAobm9kZTogU2VydmVyTm9kZSk6IFByb21pc2U8TGVmdFRvcFZhbHVlczxudW1iZXI+PiB7XG4gICAgY29uc3QgZGltZW5zaW9ucyAgICA9IGF3YWl0IGdldENsaWVudERpbWVuc2lvbnMobm9kZSk7XG4gICAgY29uc3QgeyBsZWZ0LCB0b3AgfSA9IGF3YWl0IGdldERvY3VtZW50U2Nyb2xsKG5vZGUpO1xuXG4gICAgcmV0dXJuIHsgbGVmdDogZGltZW5zaW9ucy5sZWZ0ICsgbGVmdCwgdG9wOiBkaW1lbnNpb25zLnRvcCArIHRvcCB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29udGFpbnNPZmZzZXQgKG5vZGU6IFNlcnZlck5vZGUsIG9mZnNldFg6IG51bWJlciwgb2Zmc2V0WTogbnVtYmVyKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgZGltZW5zaW9ucyA9IGF3YWl0IGdldENsaWVudERpbWVuc2lvbnMobm9kZSk7XG4gICAgY29uc3QgcHJvcGVydGllcyA9IGF3YWl0IGdldFByb3BlcnRpZXMobm9kZSwgJ3Njcm9sbFdpZHRoJywgJ3Njcm9sbEhlaWdodCcpO1xuXG4gICAgY29uc3Qgd2lkdGggID0gTWF0aC5tYXgoTnVtYmVyKHByb3BlcnRpZXMuc2Nyb2xsV2lkdGgpLCBkaW1lbnNpb25zLndpZHRoKTtcbiAgICBjb25zdCBoZWlnaHQgPSBNYXRoLm1heChOdW1iZXIocHJvcGVydGllcy5zY3JvbGxIZWlnaHQpLCBkaW1lbnNpb25zLmhlaWdodCk7XG4gICAgY29uc3QgbWF4WCAgID0gZGltZW5zaW9ucy5zY3JvbGxiYXIucmlnaHQgKyBkaW1lbnNpb25zLmJvcmRlci5sZWZ0ICsgZGltZW5zaW9ucy5ib3JkZXIucmlnaHQgKyB3aWR0aDtcbiAgICBjb25zdCBtYXhZICAgPSBkaW1lbnNpb25zLnNjcm9sbGJhci5ib3R0b20gKyBkaW1lbnNpb25zLmJvcmRlci50b3AgKyBkaW1lbnNpb25zLmJvcmRlci5ib3R0b20gKyBoZWlnaHQ7XG5cbiAgICByZXR1cm4gKHR5cGVvZiBvZmZzZXRYID09PSAndW5kZWZpbmVkJyB8fCBvZmZzZXRYID49IDAgJiYgbWF4WCA+PSBvZmZzZXRYKSAmJlxuICAgICAgICAodHlwZW9mIG9mZnNldFkgPT09ICd1bmRlZmluZWQnIHx8IG9mZnNldFkgPj0gMCAmJiBtYXhZID49IG9mZnNldFkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SWZyYW1lQ2xpZW50Q29vcmRpbmF0ZXMgKG5vZGU6IFNlcnZlck5vZGUpOiBQcm9taXNlPEJvdW5kYXJ5VmFsdWVzRGF0YT4ge1xuICAgIGNvbnN0IGRpbWVuc2lvbnMgPSBhd2FpdCBnZXRDbGllbnREaW1lbnNpb25zKG5vZGUpO1xuXG4gICAgY29uc3QgWyBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20gXSA9IFtcbiAgICAgICAgZGltZW5zaW9ucy5sZWZ0ICsgZGltZW5zaW9ucy5ib3JkZXIubGVmdCArIGRpbWVuc2lvbnMucGFkZGluZ3MubGVmdCxcbiAgICAgICAgZGltZW5zaW9ucy50b3AgKyBkaW1lbnNpb25zLmJvcmRlci50b3AgKyBkaW1lbnNpb25zLnBhZGRpbmdzLmxlZnQsXG4gICAgICAgIGRpbWVuc2lvbnMucmlnaHQgLSBkaW1lbnNpb25zLmJvcmRlci5yaWdodCAtIGRpbWVuc2lvbnMucGFkZGluZ3MucmlnaHQsXG4gICAgICAgIGRpbWVuc2lvbnMuYm90dG9tIC0gZGltZW5zaW9ucy5ib3JkZXIuYm90dG9tIC0gZGltZW5zaW9ucy5wYWRkaW5ncy5ib3R0b20sXG4gICAgXTtcblxuICAgIHJldHVybiBuZXcgQm91bmRhcnlWYWx1ZXModG9wLCByaWdodCwgYm90dG9tLCBsZWZ0KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldElmcmFtZVBvaW50UmVsYXRpdmVUb1BhcmVudEZyYW1lIChpZnJhbWVQb2ludDogQXhpc1ZhbHVlczxudW1iZXI+LCBjb250ZXh0OiBFeGVjdXRpb25Db250ZXh0KTogUHJvbWlzZTxBeGlzVmFsdWVzPG51bWJlcj4gfCBudWxsPiB7XG4gICAgY29uc3QgaWZyYW1lID0gYXdhaXQgZmluZElmcmFtZUJ5V2luZG93KGNvbnRleHQpO1xuXG4gICAgaWYgKCFpZnJhbWUpXG4gICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgY29uc3QgZGltZW5zaW9ucyA9IGF3YWl0IGdldENsaWVudERpbWVuc2lvbnMoaWZyYW1lKTtcbiAgICBjb25zdCBwYWRkaW5ncyAgID0gYXdhaXQgZ2V0RWxlbWVudFBhZGRpbmcoaWZyYW1lKTtcblxuICAgIGNvbnN0IGxlZnQgPSBkaW1lbnNpb25zLmxlZnQgKyBkaW1lbnNpb25zLmJvcmRlci5sZWZ0ICsgcGFkZGluZ3MubGVmdCArIGlmcmFtZVBvaW50Lng7XG4gICAgY29uc3QgdG9wICA9IGRpbWVuc2lvbnMudG9wICsgZGltZW5zaW9ucy5ib3JkZXIudG9wICsgcGFkZGluZ3MudG9wICsgaWZyYW1lUG9pbnQueTtcblxuICAgIHJldHVybiBuZXcgQXhpc1ZhbHVlczxudW1iZXI+KGxlZnQsIHRvcCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFbGVtZW50RnJvbVBvaW50IChwb2ludDogQXhpc1ZhbHVlc0RhdGE8bnVtYmVyPik6IFByb21pc2U8UHJvdG9jb2wuRE9NLlJlc29sdmVOb2RlUmVzcG9uc2U+IHtcbiAgICBjb25zdCB7IERPTSB9ICAgICAgICAgICA9IGNsaWVudHNNYW5hZ2VyLmdldENsaWVudCgpO1xuICAgIGNvbnN0IHsgYmFja2VuZE5vZGVJZCB9ID0gYXdhaXQgRE9NLmdldE5vZGVGb3JMb2NhdGlvbih7IHg6IHBvaW50LngsIHk6IHBvaW50LnkgfSk7XG5cbiAgICByZXR1cm4gRE9NLnJlc29sdmVOb2RlKHsgYmFja2VuZE5vZGVJZCB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFdpbmRvd1Bvc2l0aW9uICgpOiBQcm9taXNlPEF4aXNWYWx1ZXM8bnVtYmVyPj4ge1xuICAgIGNvbnN0IHsgUnVudGltZSB9ID0gY2xpZW50c01hbmFnZXIuZ2V0Q2xpZW50KCk7XG5cbiAgICBjb25zdCBhcmdzOiBQcm90b2NvbC5SdW50aW1lLkV2YWx1YXRlUmVxdWVzdCA9IHtcbiAgICAgICAgZXhwcmVzc2lvbjogYCh7XG4gICAgICAgICAgICB4OiB3aW5kb3cuc2NyZWVuTGVmdCB8fCB3aW5kb3cuc2NyZWVuWCxcbiAgICAgICAgICAgIHk6IHdpbmRvdy5zY3JlZW5Ub3AgfHwgd2luZG93LnNjcmVlbllcbiAgICAgICAgfSlgLFxuICAgICAgICByZXR1cm5CeVZhbHVlOiB0cnVlLFxuICAgIH07XG5cbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gYXdhaXQgUnVudGltZS5ldmFsdWF0ZShhcmdzKTtcblxuICAgIHJldHVybiByZXN1bHQudmFsdWU7XG59XG4iXX0=